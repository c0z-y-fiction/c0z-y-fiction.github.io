<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OWASP Top 10 for Django | 김혜진</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>

<body>
    <header>
        <h1>OWASP TOP 10</h1>
        <p>For Django Developers</p>
    </header>

    <nav>
        <a href="/">← 홈</a>
        <a href="#a01">A01</a>
        <a href="#a02">A02</a>
        <a href="#a03">A03</a>
        <a href="#incidents">실제 사건</a>
    </nav>

    <main>
        <!-- A01 섹션 -->
        <section id="a01">
            <h2>A01: Broken Access Control</h2>
            <h3>취약한 접근 제어</h3>

            <p>
                접근 제어는 사용자가 권한을 벗어난 행동을 할 수 없도록 정책을 만들고
                실행하는 기능입니다. 접근 제어가 취약하게 구현되면 사용자는 주어진
                권한을 벗어나 인가되지 않은 데이터에 무단으로 접근해 데이터를
                조작하거나 삭제할 수 있습니다.
            </p>

            <h3>취약한 코드</h3>
            <pre><code>def delete_user(request, user_id):
    user = User.objects.get(id=user_id)
    user.delete()</code></pre>

            <div class="warning">
                <strong>문제점:</strong>
                <ul>
                    <li>일반 사용자가 URL 조작만으로 계정을 삭제할 수 있습니다.</li>
                    <li>악의적인 공격자가 타인의 계정을 마음대로 삭제할 수 있습니다.</li>
                </ul>
            </div>

            <h3>안전한 코드</h3>
            <pre><code>from django.contrib.auth.decorators import permission_required

@permission_required("auth.delete_user", raise_exception=True)
def delete_user(request, user_id):
    user = User.objects.get(id=user_id)
    user.delete()</code></pre>

            <div class="success">
                <strong>개선점:</strong>
                <ul>
                    <li>서버에서 사용자의 권한을 검증합니다.</li>
                    <li>URL/API 요청에 대한 권한 체크가 적용되었습니다.</li>
                </ul>
            </div>
        </section>

        <!-- A02 섹션 -->
        <section id="a02">
            <h2>A02: Cryptographic Failures</h2>
            <h3>암호화 실패</h3>

            <p>
                암호화에 오류가 있거나 미흡한 부분이 있는 경우, 민감 데이터 노출로
                이어집니다. 특히 개인정보와 금융 데이터 같은 법과 규정에 강력하게
                영향을 받는 경우라면 해당하는 데이터를 안전하게 보호하기 위한
                추가 요구 사항을 지켜야 합니다.
            </p>

            <h3>취약한 코드</h3>
            <pre><code>user.password = "plain-text-password"
user.save()</code></pre>

            <div class="warning">
                <strong>문제점:</strong>
                <ul>
                    <li>비밀번호를 평문으로 저장합니다. 만약 DB가 유출된다면?</li>
                    <li>암호화나 해싱을 완전히 생략했습니다.</li>
                </ul>
            </div>

            <h3>안전한 코드</h3>
            <pre><code>from django.contrib.auth.hashers import make_password

user.password = make_password("securepassword")
user.save()</code></pre>

            <div class="success">
                <strong>개선점:</strong>
                <ul>
                    <li>make_password() 함수가 비밀번호에 해시를 적용합니다.</li>
                    <li>DB에는 평문이 아니라 해시된 문자열이 저장됩니다.</li>
                    <li>민감한 데이터를 안전하게 저장할 수 있는 방법입니다.</li>
                </ul>
            </div>
        </section>

        <!-- A03 섹션 -->
        <section id="a03">
            <h2>A03: Injection</h2>
            <h3>인젝션</h3>

            <p>
                인젝션은 사용자가 전달하는 데이터(파라미터, 헤더, URL, 쿠키, Json 데이터,
                XML 등 모든 형태)를 신뢰할 수 없는 데이터로 조작해서, 서버 측에서
                해당 데이터를 명령어나 쿼리문의 일부로 인식하게 만들 때 발생하는
                취약점입니다.
            </p>

            <h3>취약한 코드</h3>
            <pre><code>username = request.GET.get("username")
User.objects.raw(f"SELECT * FROM users WHERE username = '{username}'")</code></pre>

            <div class="warning">
                <strong>문제점:</strong>
                <ul>
                    <li><code>SELECT * FROM users WHERE username = '' OR '1'='1'</code>은 거의 만능입니다.</li>
                    <li>'1'='1'은 항상 참이므로, 묻지도 따지지도 않고 모든 사용자 정보를 반환합니다.</li>
                    <li>유명한 SQL Injection 예시입니다.</li>
                </ul>
            </div>

            <h3>안전한 코드</h3>
            <pre><code>User.objects.raw("SELECT * FROM users WHERE username = %s", [username])</code></pre>

            <div class="success">
                <strong>개선점:</strong>
                <ul>
                    <li>파라미터화한 쿼리(%s: 문자열)를 사용하여 악의적인 사용자가 직접 공격문을 넣어도 단순 문자열로 처리합니다.</li>
                    <li>인젝션을 효과적으로 방지할 수 있는 방법입니다.</li>
                </ul>
            </div>
        </section>

        <!-- 실제 사건 섹션 -->
        <section id="incidents">
            <h2>실제 보안 사고</h2>

            <h3>A01: Facebook (2021)</h3>
            <p>
                노출된 API를 통해 접근 제어 없이 사용자 프로필 스크랩.
                수억 명의 사용자 정보가 유출되었습니다.
            </p>

            <h3>A02: LinkedIn (2012)</h3>
            <p>
                SHA-1(Salt 없음)을 이용하여 암호화한 비밀번호가 유출됨.
                약 650만 개의 비밀번호 해시가 온라인에 공개되었습니다.
            </p>

            <h3>A03: Equifax Breach (2017)</h3>
            <p>
                패치되지 않은 Apache 취약점을 이용해 서버에서 직접 명령을 내림(HTTP Header 이용).
                1억 4천만 명 이상의 개인정보가 유출되었습니다.
            </p>
        </section>
    </main>

    <footer>
        <a href="/">홈으로</a>
        <a href="https://github.com/c0z-y-fiction">GitHub</a>
    </footer>
</body>

</html>